# 나의아저씨 - 아저씨 렌탈 서비스 상세 기획문서

## 1. 서비스 개요

### 1.1 서비스 소개
**나의아저씨**는 다양한 활동(산책, 대화, 조언 등)을 제공하는 아저씨들과 이러한 서비스를 필요로 하는 사용자들을 연결하는 플랫폼입니다.

### 1.2 핵심 가치
- **안전한 만남**: 신원 확인된 아저씨들과 공개된 장소에서 안전하게 만남
- **검증된 품질**: 리뷰와 평점 시스템으로 검증된 고품질 서비스
- **유연한 시간**: 원하는 시간과 장소에서 자유롭게 서비스 이용
- **다양한 선택**: 지역, 연령, 관심사별로 다양한 아저씨 선택 가능

### 1.3 주요 서비스 유형
| 서비스 | 설명 | 시작 요금 |
|--------|------|-----------|
| 산책 동행 | 공원이나 동네를 함께 걸으며 건강한 시간 | 15,000원/시간 |
| 대화 상대 | 인생 경험이 풍부한 아저씨와 의미있는 대화 | 20,000원/시간 |
| 조언 & 멘토링 | 취업, 인간관계, 인생 설계 등 다양한 분야 조언 | 25,000원/시간 |

---

## 2. 기술 스택

### 2.1 Frontend
| 기술 | 용도 |
|------|------|
| Next.js 14 (App Router) | 프레임워크 (SSR + CSR) |
| TypeScript | 타입 안정성 |
| Tailwind CSS | 스타일링 |
| Lucide React | 아이콘 |
| React Hook Form + Zod | 폼 처리 및 검증 |
| date-fns | 날짜 처리 |

### 2.2 Backend
| 기술 | 용도 |
|------|------|
| Supabase PostgreSQL | 데이터베이스 |
| Supabase Auth | 인증 (Google OAuth) |
| Supabase Storage | 파일 저장 (프로필 이미지) |
| Next.js API Routes | API 엔드포인트 |

### 2.3 배포
| 서비스 | 용도 |
|--------|------|
| Vercel | Frontend + API 호스팅 |
| Supabase | Backend 서비스 |

---

## 3. 데이터베이스 스키마

### 3.1 profiles (사용자 프로필)
```sql
CREATE TABLE profiles (
  id UUID REFERENCES auth.users(id) PRIMARY KEY,
  email TEXT UNIQUE NOT NULL,
  name TEXT NOT NULL,
  nickname TEXT,
  profile_image TEXT,
  introduction TEXT,
  role TEXT DEFAULT 'user' CHECK (role IN ('user', 'ajussi', 'admin')),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

| 필드 | 타입 | 설명 |
|------|------|------|
| id | UUID | Supabase Auth 사용자 ID (PK) |
| email | TEXT | 이메일 (UNIQUE) |
| name | TEXT | 실명 |
| nickname | TEXT | 닉네임 (선택) |
| profile_image | TEXT | 프로필 이미지 URL |
| introduction | TEXT | 자기소개 |
| role | TEXT | 역할 (user/ajussi/admin) |

### 3.2 ajussi_profiles (아저씨 프로필)
```sql
CREATE TABLE ajussi_profiles (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE UNIQUE,
  title TEXT NOT NULL,
  description TEXT NOT NULL,
  hourly_rate INTEGER NOT NULL,
  available_areas TEXT[] DEFAULT '{}',
  open_chat_url TEXT,
  is_active BOOLEAN DEFAULT true,
  tags TEXT[] DEFAULT '{}',
  availability_mask JSONB DEFAULT '{}',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

| 필드 | 타입 | 설명 |
|------|------|------|
| id | UUID | 아저씨 프로필 ID (PK) |
| user_id | UUID | 사용자 ID (FK, UNIQUE) |
| title | TEXT | 서비스 제목 |
| description | TEXT | 서비스 상세 설명 |
| hourly_rate | INTEGER | 시간당 요금 (원) |
| available_areas | TEXT[] | 활동 가능 지역 배열 |
| open_chat_url | TEXT | 카카오 오픈채팅 URL |
| is_active | BOOLEAN | 활동 상태 (ON/OFF) |
| tags | TEXT[] | 서비스 태그 배열 |

### 3.3 requests (서비스 요청)
```sql
CREATE TYPE request_status AS ENUM (
  'PENDING',    -- 대기중
  'CONFIRMED',  -- 확정
  'REJECTED',   -- 거절
  'COMPLETED',  -- 완료
  'CANCELLED',  -- 취소
  'EXPIRED'     -- 만료
);

CREATE TABLE requests (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  client_id UUID REFERENCES profiles(id) NOT NULL,
  ajussi_id UUID REFERENCES profiles(id) NOT NULL,
  date TIMESTAMP WITH TIME ZONE NOT NULL,
  duration INTEGER NOT NULL,
  location TEXT NOT NULL,
  description TEXT NOT NULL,
  status request_status DEFAULT 'PENDING',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

| 필드 | 타입 | 설명 |
|------|------|------|
| id | UUID | 요청 ID (PK) |
| client_id | UUID | 요청자 ID (FK) |
| ajussi_id | UUID | 아저씨 ID (FK) |
| date | TIMESTAMP | 서비스 일시 |
| duration | INTEGER | 소요 시간 (분) |
| location | TEXT | 만남 장소 |
| description | TEXT | 요청 내용 |
| status | ENUM | 요청 상태 |

### 3.4 reviews (리뷰)
```sql
CREATE TABLE reviews (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  request_id UUID REFERENCES requests(id) UNIQUE,
  reviewer_id UUID REFERENCES profiles(id) NOT NULL,
  rating INTEGER CHECK (rating >= 1 AND rating <= 5),
  comment TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

### 3.5 favorites (즐겨찾기)
```sql
CREATE TABLE favorites (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  user_id UUID REFERENCES profiles(id) NOT NULL,
  ajussi_id UUID REFERENCES profiles(id) NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  UNIQUE(user_id, ajussi_id)
);
```

### 3.6 ajussi_applications (아저씨 신청)
```sql
CREATE TABLE ajussi_applications (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  user_id UUID REFERENCES profiles(id) NOT NULL,
  title TEXT NOT NULL,
  description TEXT NOT NULL,
  hourly_rate INTEGER NOT NULL,
  available_areas TEXT[] DEFAULT '{}',
  open_chat_url TEXT NOT NULL,
  tags TEXT[] DEFAULT '{}',
  status TEXT DEFAULT 'PENDING' CHECK (status IN ('PENDING', 'APPROVED', 'REJECTED')),
  admin_notes TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

---

## 4. 페이지 구조 및 기능 명세

### 4.1 메인 페이지 (/)
**경로**: `src/app/page.tsx`

#### 화면 구성
1. **Hero 섹션**
   - 서비스 타이틀: "나의아저씨"
   - 서비스 설명 문구
   - CTA 버튼: "아저씨 찾기", "이용 가이드"
   - 통계 표시: 등록된 아저씨 수, 성사된 만남, 평균 만족도

2. **서비스 소개 섹션**
   - 산책 동행, 대화 상대, 조언 & 멘토링 카드
   - 각 서비스별 설명 및 시작 요금

3. **특징 섹션**
   - 안전한 만남, 검증된 품질, 유연한 시간, 다양한 선택

4. **인기 아저씨 섹션**
   - 평점 높은 아저씨 6명 카드 표시
   - 즐겨찾기 기능
   - "더 많은 아저씨 보기" 버튼

5. **CTA 섹션**
   - "아저씨 찾기", "아저씨 되기" 버튼

---

### 4.2 아저씨 목록 페이지 (/ajussi)
**경로**: `src/app/ajussi/page.tsx`

#### 화면 구성
1. **페이지 헤더**
   - 제목: "아저씨 찾기"
   - 설명: "다양한 활동을 함께할 아저씨를 찾아보세요"

2. **검색/필터 영역**
   - 검색어 입력 (제목, 설명 검색)
   - 지역 필터 (드롭다운)
   - 태그 필터 (다중 선택)
   - 요금 범위 필터 (최소/최대)

3. **결과 요약**
   - 총 아저씨 수 표시
   - 현재 페이지 / 전체 페이지

4. **아저씨 카드 그리드**
   - 반응형 그리드 (1~4열)
   - 카드당 정보: 프로필 이미지, 제목, 닉네임, 설명, 태그, 요금, 지역
   - 즐겨찾기 버튼

5. **페이지네이션**
   - 이전/다음 버튼
   - 페이지 번호 버튼

#### API 연동
```typescript
// GET /api/ajussi
interface GetAjussiListRequest {
  search?: string;      // 검색어
  location?: string;    // 지역 필터
  tags?: string;        // 태그 (쉼표 구분)
  minRate?: number;     // 최소 요금
  maxRate?: number;     // 최대 요금
  page?: number;        // 페이지 번호 (기본: 1)
  limit?: number;       // 페이지당 개수 (기본: 12)
}

interface GetAjussiListResponse {
  success: boolean;
  data: AjussiWithProfile[];
  meta: {
    pagination: {
      page: number;
      limit: number;
      total: number;
      totalPages: number;
    };
  };
}
```

---

### 4.3 아저씨 상세 페이지 (/ajussi/[id])
**경로**: `src/app/ajussi/[id]/page.tsx`, `src/app/ajussi/[id]/AjussiDetailClient.tsx`

#### 화면 구성
1. **프로필 섹션**
   - 프로필 이미지 (대형)
   - 서비스 제목
   - 닉네임/이름
   - 즐겨찾기 버튼

2. **서비스 정보**
   - 시간당 요금
   - 활동 가능 지역
   - 서비스 태그
   - 상세 설명

3. **액션 버튼**
   - "오픈채팅 문의" 버튼 → 카카오 오픈채팅 연결
   - "요청하기" 버튼 → 요청 모달 오픈

4. **리뷰 섹션**
   - 평균 평점 및 리뷰 수
   - 리뷰 목록 (작성자, 별점, 코멘트, 날짜)

#### 요청 모달 (RequestModal)
```typescript
interface RequestFormData {
  date: string;        // 날짜 (YYYY-MM-DD)
  time: string;        // 시간 (HH:00)
  duration: number;    // 소요시간 (분: 30~480)
  location: string;    // 만남 장소
  description: string; // 요청 내용 (10~500자)
}
```

**소요시간 옵션**: 30분, 1시간, 1시간 30분, 2시간, 3시간, 4시간, 5시간, 6시간, 7시간, 8시간

**예상 비용 계산**: `(duration / 60) * hourly_rate`

---

### 4.4 로그인 페이지 (/auth/login)
**경로**: `src/app/auth/login/page.tsx`

#### 화면 구성
1. **로그인 폼**
   - 서비스 타이틀
   - Google 로그인 버튼
   - 이용약관/개인정보처리방침 동의 안내

#### 인증 플로우
1. Google OAuth 로그인 클릭
2. Supabase Auth로 리다이렉트
3. 콜백 처리 (`/auth/callback`)
4. 신규 사용자: 프로필 설정 페이지로 이동 (`/auth/setup-profile`)
5. 기존 사용자: 메인 페이지로 이동

---

### 4.5 마이페이지 (/mypage)
**경로**: `src/app/mypage/page.tsx`

#### 화면 구성 (카드 그리드)
| 카드 | 설명 | 링크 |
|------|------|------|
| 프로필 관리 | 개인정보 및 기본 프로필 수정 | /mypage/profile |
| 아저씨 프로필 | 아저씨 서비스 정보 관리 (아저씨만) | /mypage/ajussi |
| 의뢰 관리 | 신청/받은 의뢰 확인 | /mypage/requests |
| 즐겨찾기 | 관심있는 아저씨 목록 | /mypage/favorites |
| 리뷰 관리 | 작성/받은 리뷰 확인 | /mypage/reviews |
| 아저씨 되기 | 아저씨 신청 (일반 사용자만) | /mypage/become-ajussi |

---

### 4.6 의뢰 관리 페이지 (/mypage/requests)
**경로**: `src/app/mypage/requests/page.tsx`

#### 화면 구성
1. **상태 필터**
   - 전체, 대기중, 확정, 완료, 거절, 취소

2. **탭 구분**
   - "내가 신청한 요청" (모든 사용자)
   - "내가 받은 요청" (아저씨만)

3. **요청 카드 (RequestCard)**
   - 상대방 정보 (프로필 이미지, 이름)
   - 요청 정보 (날짜, 시간, 장소, 내용)
   - 상태 배지
   - 액션 버튼 (상태별 다름)

#### 상태별 액션 버튼
| 상태 | 요청자 액션 | 아저씨 액션 |
|------|-------------|-------------|
| PENDING | 취소 | 수락, 거절 |
| CONFIRMED | 오픈채팅 연결 | 오픈채팅 연결, 완료 처리 |
| COMPLETED | 리뷰 작성 | - |
| REJECTED | - | - |
| CANCELLED | - | - |

---

### 4.7 아저씨 되기 페이지 (/mypage/become-ajussi)
**경로**: `src/app/mypage/become-ajussi/page.tsx`

#### 신청 폼 필드
| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| title | TEXT | ✓ | 서비스 제목 |
| description | TEXTAREA | ✓ | 서비스 상세 설명 |
| hourly_rate | NUMBER | ✓ | 시간당 요금 |
| available_areas | MULTI-SELECT | ✓ | 활동 가능 지역 |
| open_chat_url | URL | ✓ | 카카오 오픈채팅 URL |
| tags | MULTI-SELECT | ✓ | 서비스 태그 |

#### 신청 프로세스
1. 사용자가 신청서 작성 및 제출
2. `ajussi_applications` 테이블에 PENDING 상태로 저장
3. 관리자가 검토 후 승인/거절
4. 승인 시: `profiles.role`을 'ajussi'로 변경, `ajussi_profiles` 생성
5. 거절 시: 거절 사유와 함께 상태 업데이트

---

### 4.8 관리자 페이지 (/admin)
**경로**: `src/app/admin/page.tsx`

#### 접근 권한
- `profiles.role === 'admin'`인 사용자만 접근 가능

#### 화면 구성
1. **신청서 목록**
   - 신청서 카드 (제목, 설명, 요금, 지역, 태그, 오픈채팅 URL)
   - 상태 배지 (대기중, 승인됨, 거절됨)
   - 신청일 표시

2. **액션 버튼** (PENDING 상태만)
   - 승인 버튼
   - 거절 버튼 (사유 입력 필요)

#### API 엔드포인트
```typescript
// GET /api/admin/applications - 신청서 목록 조회
// POST /api/admin/applications/[id]/approve - 승인
// POST /api/admin/applications/[id]/reject - 거절 (body: { reason: string })
```

---

### 4.9 이용 가이드 페이지 (/guide)
**경로**: `src/app/guide/page.tsx`

#### 섹션 구성
1. **서비스 이용 절차**
   - 아저씨 찾기 → 오픈채팅 문의 → 공식 요청 → 서비스 완료

2. **안전 수칙**
   - 공개된 장소에서 만나기 (필수)
   - 사전 오픈채팅 문의 (필수)
   - 지인에게 일정 공유 (권장)
   - 개인정보 보호 (주의)

3. **자주 묻는 질문 (FAQ)**
   - 결제 방법
   - 취소 정책
   - 아저씨 되는 방법
   - 문제 발생 시 대처
   - 리뷰 작성 시점

4. **주의사항**
   - 불법/부적절한 요청 금지
   - 상호 존중
   - 플랫폼 외 거래 비권장
   - 허위 정보/사기 행위 처벌

5. **고객 지원**
   - 전화: 1588-0000 (평일 09:00-18:00)
   - 이메일: support@ajussi-rental.com

---

## 5. API 명세

### 5.1 아저씨 관련 API

#### GET /api/ajussi
아저씨 목록 조회 (필터링, 페이지네이션 지원)

#### GET /api/ajussi/[id]
아저씨 상세 정보 조회 (프로필 + 리뷰)

---

### 5.2 요청 관련 API

#### POST /api/requests
서비스 요청 생성
```typescript
// Request Body
{
  ajussiId: string;
  date: string;      // YYYY-MM-DD
  time: string;      // HH:00
  duration: number;  // 분
  location: string;
  description: string;
}
```

#### GET /api/requests
요청 목록 조회
```typescript
// Query Parameters
{
  type?: 'sent' | 'received';
  status?: RequestStatus;
  page?: number;
  limit?: number;
}
```

#### PUT /api/requests/[id]
요청 상태 변경
```typescript
// Request Body
{
  status: 'CONFIRMED' | 'REJECTED' | 'COMPLETED' | 'CANCELLED';
}
```

---

### 5.3 즐겨찾기 API

#### GET /api/favorites
내 즐겨찾기 목록 조회

#### POST /api/favorites
즐겨찾기 토글 (추가/제거)
```typescript
// Request Body
{ ajussiId: string }

// Response
{ success: true, action: 'added' | 'removed' }
```

---

### 5.4 프로필 API

#### GET /api/profile
내 프로필 조회

#### PUT /api/profile
프로필 수정

---

### 5.5 리뷰 API

#### POST /api/reviews
리뷰 작성
```typescript
// Request Body
{
  requestId: string;
  rating: number;    // 1-5
  comment?: string;
}
```

---

### 5.6 아저씨 신청 API

#### POST /api/ajussi-application
아저씨 신청서 제출

#### GET /api/admin/applications
신청서 목록 조회 (관리자 전용)

#### POST /api/admin/applications/[id]/approve
신청 승인 (관리자 전용)

#### POST /api/admin/applications/[id]/reject
신청 거절 (관리자 전용)

---

## 6. 컴포넌트 구조

### 6.1 레이아웃 컴포넌트
```
src/components/layout/
├── Container.tsx      # 컨테이너 래퍼
├── Header.tsx         # 네비게이션 헤더
├── Footer.tsx         # 푸터
└── PageHeader.tsx     # 페이지 헤더 (제목, 설명, 브레드크럼)
```

### 6.2 UI 컴포넌트
```
src/components/ui/
├── Avatar.tsx         # 프로필 이미지
├── Badge.tsx          # 상태/태그 배지
├── Breadcrumb.tsx     # 브레드크럼
├── Button.tsx         # 버튼
├── Card.tsx           # 카드
├── Checkbox.tsx       # 체크박스
├── Form.tsx           # 폼 래퍼
├── ImageUpload.tsx    # 이미지 업로드
├── Input.tsx          # 입력 필드
├── Loading.tsx        # 로딩 스피너
├── Modal.tsx          # 모달
├── Select.tsx         # 셀렉트 박스
├── Tabs.tsx           # 탭
├── Textarea.tsx       # 텍스트 영역
└── Toast.tsx          # 토스트 알림
```

### 6.3 기능 컴포넌트
```
src/components/ajussi/
├── AjussiCard.tsx     # 아저씨 카드
└── SearchFilter.tsx   # 검색/필터

src/components/request/
├── RequestCard.tsx    # 요청 카드
└── RequestModal.tsx   # 요청 모달

src/components/auth/
├── AuthLoadingWrapper.tsx  # 인증 로딩 래퍼
└── ProtectedRoute.tsx      # 보호된 라우트

src/components/providers/
└── AuthProvider.tsx   # 인증 컨텍스트 프로바이더
```

---

## 7. 인증 및 권한

### 7.1 사용자 역할
| 역할 | 설명 | 권한 |
|------|------|------|
| user | 일반 사용자 | 아저씨 검색, 요청 생성, 리뷰 작성 |
| ajussi | 아저씨 | user 권한 + 요청 수락/거절, 프로필 관리 |
| admin | 관리자 | 모든 권한 + 신청 승인/거절 |

### 7.2 Row Level Security (RLS) 정책
```sql
-- 프로필: 모든 사용자 조회 가능, 본인만 수정 가능
-- 아저씨 프로필: 활성화된 프로필만 조회 가능, 본인만 수정 가능
-- 요청: 관련 당사자만 조회/수정 가능
-- 리뷰: 모든 사용자 조회 가능, 작성자만 생성 가능
-- 즐겨찾기: 본인 것만 조회/수정 가능
```

---

## 8. 환경 변수

```env
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=xxx
SUPABASE_SERVICE_ROLE_KEY=xxx

# Site
NEXT_PUBLIC_SITE_URL=https://your-domain.com
```

---

## 9. 배포 체크리스트

### 9.1 Supabase 설정
- [ ] 프로젝트 생성
- [ ] 데이터베이스 마이그레이션 실행
- [ ] RLS 정책 설정
- [ ] Google OAuth 프로바이더 설정
- [ ] Storage 버킷 생성 (프로필 이미지)

### 9.2 Vercel 설정
- [ ] 프로젝트 연결
- [ ] 환경 변수 설정
- [ ] 도메인 설정

### 9.3 초기 데이터
- [ ] 관리자 계정 생성 (role: 'admin')
- [ ] 테스트 아저씨 데이터 생성

---

## 10. 향후 개선 사항

### 10.1 기능 개선
- [ ] 카카오 로그인 추가
- [ ] 온라인 결제 시스템 도입
- [ ] 실시간 알림 (Supabase Realtime)
- [ ] 채팅 기능 내재화
- [ ] 아저씨 일정 관리 캘린더

### 10.2 성능 개선
- [ ] 이미지 최적화 (Next.js Image)
- [ ] 검색 성능 개선 (Full-text search)
- [ ] 캐싱 전략 수립

### 10.3 사용자 경험
- [ ] PWA 지원
- [ ] 다크 모드
- [ ] 다국어 지원


---

## 11. 화면 와이어프레임 (텍스트 기반)

### 11.1 메인 페이지 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│ [로고] 나의아저씨        [아저씨 찾기] [가이드] [로그인]    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│                    ★ 나의아저씨 ★                          │
│                                                             │
│     산책, 대화, 조언 등 다양한 활동을 함께할                │
│     아저씨를 찾아보세요.                                    │
│                                                             │
│         [아저씨 찾기]    [이용 가이드]                      │
│                                                             │
│     100+        500+        4.8        24/7                 │
│   등록된 아저씨  성사된 만남  평균 만족도  고객 지원        │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                    다양한 서비스                            │
│                                                             │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐                  │
│  │ 🚶‍♂️       │  │ 💬       │  │ 💡       │                  │
│  │ 산책 동행 │  │ 대화 상대 │  │ 조언     │                  │
│  │          │  │          │  │ 멘토링   │                  │
│  │ 15,000원~│  │ 20,000원~│  │ 25,000원~│                  │
│  └──────────┘  └──────────┘  └──────────┘                  │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                    인기 아저씨들                            │
│                                                             │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐          │
│  │ [사진]  │ │ [사진]  │ │ [사진]  │ │ [사진]  │          │
│  │ 제목    │ │ 제목    │ │ 제목    │ │ 제목    │          │
│  │ 닉네임  │ │ 닉네임  │ │ 닉네임  │ │ 닉네임  │          │
│  │ 요금/지역│ │ 요금/지역│ │ 요금/지역│ │ 요금/지역│          │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘          │
│                                                             │
│              [더 많은 아저씨 보기 →]                        │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                    지금 시작해보세요                        │
│                                                             │
│         [아저씨 찾기]    [아저씨 되기]                      │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│ [푸터: 이용약관 | 개인정보처리방침 | 고객센터]              │
└─────────────────────────────────────────────────────────────┘
```

### 11.2 아저씨 목록 페이지 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│ [헤더]                                                      │
├─────────────────────────────────────────────────────────────┤
│ 홈 > 아저씨 찾기                                            │
│                                                             │
│ 아저씨 찾기                                                 │
│ 다양한 활동을 함께할 아저씨를 찾아보세요                    │
├─────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [🔍 검색어 입력...]                                     │ │
│ │                                                         │ │
│ │ 지역: [전체 ▼]  태그: [선택 ▼]  요금: [___] ~ [___]원  │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 총 42명의 아저씨가 있습니다              페이지 1 / 4       │
│                                                             │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│ │ [사진]♡ │ │ [사진]♡ │ │ [사진]♡ │ │ [사진]♡ │           │
│ │ 제목    │ │ 제목    │ │ 제목    │ │ 제목    │           │
│ │ 닉네임  │ │ 닉네임  │ │ 닉네임  │ │ 닉네임  │           │
│ │ 설명... │ │ 설명... │ │ 설명... │ │ 설명... │           │
│ │ #태그   │ │ #태그   │ │ #태그   │ │ #태그   │           │
│ │ 💰요금  │ │ 💰요금  │ │ 💰요금  │ │ 💰요금  │           │
│ │ 📍지역  │ │ 📍지역  │ │ 📍지역  │ │ 📍지역  │           │
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘           │
│                                                             │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│ │  ...    │ │  ...    │ │  ...    │ │  ...    │           │
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘           │
│                                                             │
│           [< 이전] [1] [2] [3] [4] [다음 >]                 │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 11.3 아저씨 상세 페이지 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│ [헤더]                                                      │
├─────────────────────────────────────────────────────────────┤
│ 홈 > 아저씨 찾기 > 상세                                     │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────┐                                          │
│  │              │   함께 산책하며 인생 이야기 나눠요        │
│  │   [프로필    │   김철수 아저씨                    [♡]   │
│  │    사진]     │                                          │
│  │              │   #산책 #대화 #조언                       │
│  └──────────────┘                                          │
│                                                             │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                                             │
│  💰 시간당 요금                                             │
│  20,000원                                                   │
│                                                             │
│  📍 활동 가능 지역                                          │
│  서울 강남구, 서울 서초구, 서울 송파구                      │
│                                                             │
│  📝 서비스 소개                                             │
│  안녕하세요! 30년간 직장생활을 하며 다양한 경험을           │
│  쌓은 50대 아저씨입니다. 함께 산책하며 편안하게             │
│  이야기 나누고 싶으신 분들 환영합니다...                    │
│                                                             │
│  ┌─────────────────────┐ ┌─────────────────────┐           │
│  │   오픈채팅 문의     │ │     요청하기        │           │
│  └─────────────────────┘ └─────────────────────┘           │
│                                                             │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                                             │
│  리뷰 (12개)                           평균 ★★★★☆ 4.5      │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ [사진] 홍길동님                    ★★★★★ 5.0         │   │
│  │ 정말 좋은 시간이었습니다. 다양한 조언 감사합니다!   │   │
│  │ 2024.01.15                                          │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 11.4 요청 모달 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│                    서비스 요청하기                     [X]  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  요청 대상                                                  │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 김철수 아저씨                                       │   │
│  │ 시간당 20,000원                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  날짜 *                        시간 *                       │
│  ┌──────────────────┐         ┌──────────────────┐         │
│  │ 2024-01-20    📅 │         │ 14:00         ▼ │         │
│  └──────────────────┘         └──────────────────┘         │
│                                                             │
│  소요 시간 *                                                │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 2시간                                            ▼ │   │
│  └─────────────────────────────────────────────────────┘   │
│  예상 비용: 40,000원                                        │
│                                                             │
│  만날 장소 *                                                │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 강남역 2번 출구                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  요청 내용 *                                                │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 함께 산책하면서 취업 관련 조언을 듣고 싶습니다.     │   │
│  │ 특히 이직 시 고려해야 할 점들에 대해...             │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 📋 요청 전 확인사항                                 │   │
│  │ • 요청 후 아저씨의 수락을 기다려주세요              │   │
│  │ • 공개된 장소에서 만나시기를 권장합니다             │   │
│  │ • 서비스 이용 후 리뷰를 남겨주세요                  │   │
│  │ • 취소는 24시간 전까지 가능합니다                   │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│              [취소]              [요청하기]                  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 11.5 의뢰 관리 페이지 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│ [헤더]                                                      │
├─────────────────────────────────────────────────────────────┤
│ 마이페이지 > 의뢰 관리                                      │
│                                                             │
│ 의뢰 관리                                                   │
│ 서비스 요청 내역을 확인하고 관리하세요                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 상태: [전체 상태 ▼]                                         │
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [내가 신청한 요청 (3)]  │  [내가 받은 요청 (5)]         │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [사진] 김철수 아저씨                        [대기중]    │ │
│ │                                                         │ │
│ │ 📅 2024-01-20 14:00 (2시간)                             │ │
│ │ 📍 강남역 2번 출구                                      │ │
│ │ 💰 예상 비용: 40,000원                                  │ │
│ │                                                         │ │
│ │ 함께 산책하면서 취업 관련 조언을 듣고 싶습니다...       │ │
│ │                                                         │ │
│ │                                    [신청 취소]          │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [사진] 박영희 아저씨                        [확정]      │ │
│ │                                                         │ │
│ │ 📅 2024-01-22 10:00 (1시간)                             │ │
│ │ 📍 올림픽공원 정문                                      │ │
│ │ 💰 예상 비용: 15,000원                                  │ │
│ │                                                         │ │
│ │ 아침 산책 함께 하고 싶습니다.                           │ │
│ │                                                         │ │
│ │                    [오픈채팅 연결]  [완료 처리]         │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 12. 상태 흐름도

### 12.1 서비스 요청 상태 흐름
```
                    ┌─────────────┐
                    │   PENDING   │ (대기중)
                    │  요청 생성  │
                    └──────┬──────┘
                           │
           ┌───────────────┼───────────────┐
           │               │               │
           ▼               ▼               ▼
    ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
    │  CONFIRMED  │ │  REJECTED   │ │  CANCELLED  │
    │   (확정)    │ │   (거절)    │ │   (취소)    │
    │ 아저씨 수락 │ │ 아저씨 거절 │ │ 요청자 취소 │
    └──────┬──────┘ └─────────────┘ └─────────────┘
           │
           ▼
    ┌─────────────┐
    │  COMPLETED  │
    │   (완료)    │
    │ 서비스 완료 │
    └─────────────┘
```

### 12.2 아저씨 신청 상태 흐름
```
    ┌─────────────┐
    │   PENDING   │ (대기중)
    │  신청 제출  │
    └──────┬──────┘
           │
           │ 관리자 검토
           │
    ┌──────┴──────┐
    │             │
    ▼             ▼
┌─────────┐ ┌─────────┐
│ APPROVED│ │ REJECTED│
│ (승인)  │ │ (거절)  │
└────┬────┘ └─────────┘
     │
     ▼
┌─────────────────────┐
│ profiles.role =     │
│ 'ajussi'            │
│                     │
│ ajussi_profiles     │
│ 레코드 생성         │
└─────────────────────┘
```

---

## 13. 보안 고려사항

### 13.1 인증/인가
- Supabase Auth를 통한 JWT 기반 인증
- Row Level Security (RLS)로 데이터 접근 제어
- 역할 기반 접근 제어 (user/ajussi/admin)

### 13.2 데이터 보호
- 민감한 개인정보 최소 수집
- HTTPS 통신 필수
- 환경 변수로 API 키 관리

### 13.3 입력 검증
- Zod 스키마를 통한 클라이언트/서버 검증
- SQL Injection 방지 (Supabase 파라미터화 쿼리)
- XSS 방지 (React 자동 이스케이프)

---

## 14. 성능 최적화

### 14.1 프론트엔드
- Next.js Image 컴포넌트로 이미지 최적화
- 동적 임포트로 코드 스플리팅
- 페이지네이션으로 데이터 로딩 최적화

### 14.2 백엔드
- 데이터베이스 인덱스 설정
  - `idx_ajussi_profiles_active`: 활성 아저씨 필터링
  - `idx_ajussi_profiles_rate`: 요금 범위 검색
  - `idx_ajussi_profiles_tags`: 태그 검색 (GIN)
  - `idx_requests_client/ajussi`: 요청 조회
  - `idx_requests_status/date`: 상태/날짜 필터링

### 14.3 캐싱
- Vercel Edge Network CDN
- Supabase 자동 캐싱

---

이 문서는 현재 구현된 "나의아저씨" 서비스의 전체 기능과 구조를 상세히 기술한 것입니다.
새로운 개발자가 이 문서를 참고하여 동일한 서비스를 구현할 수 있도록 작성되었습니다.
